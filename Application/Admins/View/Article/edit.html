<include file="Public/header" />

		<div class="main clearfix">
			<include file="Public/menu" />
			
			<div class="main-content">
				
					 <div class="box-content">
		            <form class="form-horizontal" onsubmit="return false">
		              <input type="hidden" name="id" value="{$data.id|default=''}">
		                    <div class="control-group">
		                        <label class="control-label" for="typeahead">标题</label>
		                        <div class="controls">
		                            <input type="text" name="title" value="{$data.title}">
		                        </div>
		                    </div>
		                    <div class="control-group">
		                        <label class="control-label" for="typeahead">分类</label>
		                        <div class="controls">
		                            <select name="cate" >
		                                <volist  name="cate_list" id="vo" >
		                                    <if condition="$vo['id'] eq $data['cate_id']">
		                                        <option value="{$vo.id}" selected = "selected">{$vo.cate_name}</option>
		                                        <else />
		                                        <option value="{$vo.id}" >{$vo.cate_name}</option>
		                                    </if>
		                                </volist>
		                            </select>
		                        </div>
		                    </div>
		                   
		                    <div class="control-group hidden-phone">
		                        <label class="control-label" for="textarea2">内容</label>
		                        <div class="controls article-eidit-div">
		                            <!-- 加载编辑器的容器 -->
		                            <script id="container" name="content" type="text/plain">

                            </script>
		                        </div>
		                    </div>
		                    <div class="form-actions">
		                        <button type="submit" class="btn btn-primary" onclick="postarticleinfo()">保存</button>
		                        
		                    </div>
		            </form>
		
		        </div>
		        
			</div>
		</div>
		
		<include file="Public/footer" />
</body>


<!-- 配置文件 -->
<script type="text/javascript" src="/Public/plugin/ueditor/ueditor.config.js"></script>
<!-- 编辑器源码文件 -->
<script type="text/javascript" src="/Public/plugin/ueditor/ueditor.all.js"></script>
<!-- 实例化编辑器 -->
<script type="text/javascript">
   
    var ue = UE.getEditor('container',{
        autoFloatEnabled: false,
        initialFrameWidth : 800,
        initialFrameHeight: 600,
        scaleEnabled:true
    });

    ue.ready(function () {
        ue.setContent("{$data.content}");
    });
    function postarticleinfo() {
        var atrdata ={};
        atrdata.title = $('input[name="title"]').val();
       // atrdata.fileInput = $('input[name="fileInput"]').val();
        atrdata.cate_id = $('select[name="cate"]').val();
        atrdata.id = $('input[name="id"]').val();
        if(ue.queryCommandState('source')) ue.execCommand( 'source');
        atrdata.content = ue.getContent();
        $.ajax({
            url:'{:U("Article/save")}',
            data:atrdata,
            type:'post',
            dataType:'json',
            success:function (data) {
                    if(data.code==200){
                       window.location.href='{:U("Article/index")}';
                    }else{
                        console.log(data.msg);
                    }
            }
        })
    }
</script>

</html>